<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4K IPTV PLAYER PRO</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background: radial-gradient(circle, #1a0101 0%, #000 100%); color: white; font-family: 'Segoe UI', sans-serif; height: 100vh; overflow: hidden; }
        .container { display: flex; flex-direction: column; height: 100%; padding: 15px; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .logo { font-size: 22px; font-weight: 900; color: #00d4ff; text-transform: uppercase; }
        .main-menu { display: grid; grid-template-columns: 1.5fr 1fr 1fr; grid-template-rows: repeat(3, 1fr); gap: 10px; flex-grow: 1; }
        .menu-item { background: #3d0000; border-radius: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; border: 1px solid rgba(255,255,255,0.05); transition: 0.2s; }
        .menu-item:active { transform: scale(0.95); background: #b00020; }
        .live { grid-row: span 2; background: #700000; }
        #pl-status { font-size: 10px; padding: 4px 10px; border-radius: 20px; background: #000; border: 1px solid gold; color: gold; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 3000; align-items: center; justify-content: center; padding: 20px; }
        .modal-content { background: #111; padding: 20px; border-radius: 15px; width: 100%; max-width: 350px; border: 1px solid #b00020; text-align: center; }
        .btn { width: 100%; padding: 12px; background: #b00020; border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; margin-top: 10px; }
        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #444; background: #222; color: white; }
        #viewer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 2000; overflow-y: auto; padding: 15px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; }
        .card { background: #111; border-radius: 8px; overflow: hidden; border: 1px solid #222; font-size: 10px; text-align: center; }
        .card img { width: 100%; height: 140px; object-fit: cover; background: #000; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <div class="logo">4K<span> IPTV</span></div>
        <div id="pl-status">âšª OFF</div>
    </div>
    <div class="main-menu">
        <div class="menu-item live" onclick="exibir('TV')"><i class="fas fa-tv" style="font-size:35px;margin-bottom:8px"></i><span>Live</span></div>
        <div class="menu-item" onclick="exibir('MOVIE')"><i class="fas fa-play-circle" style="font-size:25px;margin-bottom:8px"></i><span>Movies</span></div>
        <div class="menu-item" onclick="alert('Player v5.0 Pro Ativo')"><i class="fas fa-cog" style="font-size:25px;margin-bottom:8px"></i><span>Settings</span></div>
        <div class="menu-item" onclick="exibir('SERIES')"><i class="fas fa-list" style="font-size:25px;margin-bottom:8px"></i><span>Series</span></div>
        <div class="menu-item" onclick="location.reload()"><i class="fas fa-sync-alt" style="font-size:25px;margin-bottom:8px"></i><span>Reload</span></div>
        <div class="menu-item" onclick="document.getElementById('mAdd').style.display='flex'"><i class="fas fa-user-circle" style="font-size:25px;margin-bottom:8px"></i><span>Account</span></div>
        <div class="menu-item" style="background: #222;" onclick="localStorage.clear();location.reload();"><i class="fas fa-sign-out-alt" style="font-size:25px;margin-bottom:8px"></i><span>Exit</span></div>
    </div>
</div>

<div id="viewer">
    <button onclick="document.getElementById('viewer').style.display='none'" class="btn" style="width: 80px; margin-bottom: 15px; padding: 8px; font-size: 12px;">VOLTAR</button>
    <div id="grid" class="grid"></div>
</div>

<div id="mAdd" class="modal">
    <div class="modal-content">
        <h3 style="margin-bottom: 10px;">Configurar Playlist</h3>
        <p style="font-size: 12px; color: #888;">Cole o link M3U abaixo:</p>
        <input type="text" id="urlIn" placeholder="http://...">
        <button class="btn" onclick="salvar()">ATIVAR LISTA</button>
        <p onclick="document.getElementById('mAdd').style.display='none'" style="margin-top:15px; cursor:pointer; font-size: 12px; color: #666;">Cancelar</p>
    </div>
</div>

<script>
    let canais = [];
    function salvar() { 
        let u = document.getElementById('urlIn').value.trim(); 
        if(u){ localStorage.setItem('iptv_url', u); location.reload(); } 
    }

    async function carregar() {
        const u = localStorage.getItem('iptv_url');
        if(!u) return;
        const status = document.getElementById('pl-status');
        status.innerText = "â³ Lendo...";

        // PROXY ULTRA RESISTENTE (Ignora bloqueios de navegador)
        const proxy = "https://api.allorigins.win/get?url=";
        
        try {
            const res = await fetch(proxy + encodeURIComponent(u));
            const json = await res.json();
            const data = json.contents;
            
            if(!data || !data.includes('#EXTM3U')) throw new Error();

            const linhas = data.split('\n');
            let item = null;
            canais = [];
            linhas.forEach(l => {
                if(l.startsWith('#EXTINF:')) {
                    const n = l.split(',')[1] || "Canal";
                    const lg = l.match(/tvg-logo="([^"]+)"/)?.[1] || "";
                    const g = l.match(/group-title="([^"]+)"/)?.[1] || "Canais";
                    item = { n, lg, g: g.toUpperCase() };
                } else if(l.startsWith('http') && item) {
                    item.u = l.trim();
                    canais.push(item);
                    item = null;
                }
            });
            status.innerText = "ðŸŸ¢ Online: " + canais.length;
            status.style.color = "#00ff00";
        } catch(e) {
            status.innerText = "ðŸ”´ Link com Erro";
            status.style.color = "red";
        }
    }

    function exibir(t) {
        if(canais.length === 0) return;
        document.getElementById('viewer').style.display = 'block';
        const g = document.getElementById('grid');
        g.innerHTML = "";
        const f = canais.filter(i => i.g.includes(t) || (t === 'TV' && !i.g.includes('MOVIE') && !i.g.includes('SERIE')));
        f.slice(0, 150).forEach(i => {
            g.innerHTML += `
                <div class="card" onclick="alert('O Player vai abrir: ' + '${i.n}')">
                    <img src="${i.lg}" onerror="this.src='https://via.placeholder.com/150x200?text=SINAL'">
                    <div style="padding:4px">${i.n.substring(0,15)}</div>
                </div>`;
        });
    }
    carregar();
</script>
</body>
</html>
